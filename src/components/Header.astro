---
import { Image } from 'astro:assets';
import logoImage from '../assets/images/logo.jpeg';

const { pathname } = Astro.url;
const lang = pathname.startsWith('/en') ? 'en' : pathname.startsWith('/de') ? 'de' : 'nl';

const translations = {
  nl: {
    home: 'Home',
    accommodatie: 'Accommodatie',
    omgeving: 'Omgeving',
    galerij: 'Galerij',
    contact: 'Contact'
  },
  en: {
    home: 'Home',
    accommodatie: 'Accommodation',
    omgeving: 'Surroundings',
    galerij: 'Gallery',
    contact: 'Contact'
  },
  de: {
    home: 'Home',
    accommodatie: 'Unterkunft',
    omgeving: 'Umgebung',
    galerij: 'Galerie',
    contact: 'Kontakt'
  }
};

const t = translations[lang];

const getLink = (path: string) => {
  if (lang === 'nl') return path;
  return `/${lang}${path}`;
};

const links = [
  { href: getLink('/'), label: t.home },
  { href: getLink('/accommodatie'), label: t.accommodatie },
  { href: getLink('/omgeving'), label: t.omgeving },
  { href: getLink('/galerij'), label: t.galerij },
  { href: getLink('/contact'), label: t.contact },
];

const getLangLink = (targetLang: string) => {
  let cleanPath = pathname;
  if (lang !== 'nl') {
    cleanPath = pathname.replace(`/${lang}`, '') || '/';
  }
  if (targetLang === 'nl') return cleanPath;
  return `/${targetLang}${cleanPath === '/' ? '' : cleanPath}`;
};
---

<header class="bg-white/90 backdrop-blur-md shadow-sm sticky top-0 z-50">
  <div class="container mx-auto px-4 py-4 flex justify-between items-center">
    <a href="/" class="block w-[150px]">
      <Image src={logoImage} alt="B&B De Flierefluiter" class="w-full h-auto mix-blend-multiply" />
    </a>

    <!-- Desktop Menu -->
    <nav class="hidden md:flex items-center space-x-8">
      {links.map(link => (
        <a 
          href={link.href} 
          class="text-text hover:text-primary font-medium transition-colors duration-200"
        >
          {link.label}
        </a>
      ))}
      
      <!-- Language Switcher -->
      <div class="flex items-center space-x-2 border-l pl-4 border-gray-300">
        <a href={getLangLink('nl')} class={`font-medium ${lang === 'nl' ? 'text-primary' : 'text-text/60 hover:text-primary'}`}>NL</a>
        <a href={getLangLink('en')} class={`font-medium ${lang === 'en' ? 'text-primary' : 'text-text/60 hover:text-primary'}`}>EN</a>
        <a href={getLangLink('de')} class={`font-medium ${lang === 'de' ? 'text-primary' : 'text-text/60 hover:text-primary'}`}>DE</a>
      </div>
    </nav>

    <!-- Mobile Menu Button -->
    <button id="mobile-menu-btn" class="md:hidden text-text focus:outline-none" aria-label="Menu">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
  </div>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-100">
    <nav class="flex flex-col p-4 space-y-4">
      {links.map(link => (
        <a 
          href={link.href} 
          class="text-text hover:text-primary font-medium transition-colors duration-200 block"
        >
          {link.label}
        </a>
      ))}
      
      <!-- Mobile Language Switcher -->
      <div class="flex items-center space-x-4 pt-4 border-t border-gray-100">
        <a href={getLangLink('nl')} class={`font-medium ${lang === 'nl' ? 'text-primary' : 'text-text/60'}`}>NL</a>
        <a href={getLangLink('en')} class={`font-medium ${lang === 'en' ? 'text-primary' : 'text-text/60'}`}>EN</a>
        <a href={getLangLink('de')} class={`font-medium ${lang === 'de' ? 'text-primary' : 'text-text/60'}`}>DE</a>
      </div>
    </nav>
  </div>
</header>

<script>
  const btn = document.getElementById('mobile-menu-btn');
  const menu = document.getElementById('mobile-menu');

  if (btn && menu) {
    btn.addEventListener('click', () => {
      menu.classList.toggle('hidden');
    });
  }
</script>
